---
layout: post
title: "MT4におけるif分岐処理"
date: 2013-07-27 23:13
comments: true
categories: 
---

# 分岐処理(if, else)

EAをうまくプログラムするには、条件分岐というものが必ず必要となるでしょう。
例えば、以下のような条件分岐が考えられます。

  - 例：USDJPYにおいて、Askが100円を超えたら、買いポジションを持つ。
  - 例：持ったポジションの総ロットサイズが10万通貨を超えたら、新規ポジションは持たない。
  - 例：５分間の高値と安値の差が30pips以上開いていたら、両建てでポジションを持つ。

  __⇒if文というものを使うと条件分岐を実現することができます。__

　
### if文の書き方の例を何種類か

例えば、現在のチャートの通貨ペアがUSDJPYであった場合のif文の書き方の例を次に示します。
なお、例中で出現する「Symbol()」は、チャートの通貨ペアを返す（教えてくれる）Metatrader4の標準関数です。
（標準関数＝Metatrader4自体が提供してくれる、便利な関数のこと。標準関数以外の機能が必要になったら、自分で作らなければなりません。）  

- 簡単な条件分岐（XXの場合）  
ifを使うと、「XXな場合」を表現できます。
```
if ( Symbol() == "USDJPY" ) {
  // このチャートの通貨ペアがUSDJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはUSDJPYです。");
}
```
　

- 簡単な条件分岐（XXではないの場合）  
if文の評価式(カッコ内に書く式)で、!=を使うと、「XXではない場合」を表現できます。
```
if ( Symbol() != "USDJPY" ) {
  // このチャートの通貨ペアがUSDJPYではない場合、コメント表示する
  Comment("このチャートの通貨ペアはUSDJPYではありません。");
}
```
　

- 簡単な条件分岐（XX以外の場合）  
elseを使うと、「XX以外の場合」を表現できます。
```
if ( Symbol() == "USDJPY" ) {
  // このチャートの通貨ペアがUSDJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはUSDJPYです。");

} else {
  // そうではない場合
  Comment("このチャートの通貨ペアはUSDJPYではありません。");

}
```
　

- 複数の条件分岐 その1  
else ifを使うと、「XXではないけど、YYだった場合」を表現できます。
```
if ( Symbol() == "USDJPY" ) {
  // このチャートの通貨ペアがUSDJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはUSDJPYです。");

} else if ( Symbol() == "EURJPY"){
  // このチャートの通貨ペアがEURJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはEURJPYです。");

}
```
　

- 複数の条件分岐 その2  
else ifの後にも、elseを追加することができます。
```
if ( Symbol() == "USDJPY" ) {
  // このチャートの通貨ペアがUSDJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはUSDJPYです。");

} else if ( Symbol() == "EURJPY"){
  // このチャートの通貨ペアがEURJPYだった場合、コメント表示する
  Comment("このチャートの通貨ペアはEURJPYです。");

} else {
  // そうではない場合
  Comment("このチャートの通貨ペアはUSDJPYでもEURJPYでもありません。");

}
```
　

- and(かつ)とor(または）を使った条件分岐 その1   
&&を使うと、「XXかつYYだった場合」を表現できます。
```
if ( Symbol() == "USDJPY" && Bid < 76.00) {
  //  チャートの通貨ペアがUSDJPY かつ Bidが76円未満だった場合、コメント表示する
  Comment("すごく円高です！");

}
```
　

- and(かつ)とor(または）を使った条件分岐 その2  
||を使うと、「XXか、またはYYだった場合」を表現できます。
```
if ( Symbol() == "USDJPY" || Symbol() == "EURJPY") {
  //  チャートの通貨ペアがUSDJPYか、またはEURJPYだった場合、コメント表示する
  Comment("現在の通貨ペアは、USDJPYか、またはEURJPYです。");

}
```
　

- 条件分岐の中の条件分岐  
if文のブロックの中でも、if文を使うことができます。  
```
//  チャートの通貨ペアがUSDJPYだった場合
if ( Symbol() == "USDJPY") {  
  if ( Bid < 76.00) {
    //  Bidが76円未満だった場合、コメント表示する
    Comment("すごく円高です！");
  
  }
}
```
　
> __所長の一言__
>  
> たくさんのif文を書き連ねてコードを書くと、プロっぽくてかっこ良く思える人もいるかもしれませんが、
> 業界の人はなるべくif文をたくさん使わない(if文の中にif文を書かない)よう、工夫してコードを書く人が多いです。
> 
> コードの品質を高めるための検査指標として、プログラムの「複雑度」というものがあります。 
> if文を増やすと、「複雑度」が高まり、知らず知らずのうちにプログラムミスが増えるのがその理由です。
> 
> 複雑な売買ロジックであったとしても、なるべく複雑度が低く、可読性が高い（コードをひと目見て、簡単に理解できる）状態になることが望ましいです。
>
  

